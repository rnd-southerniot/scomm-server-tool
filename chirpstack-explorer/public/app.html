<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChirpStack Explorer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --p-900:#2E3478; --p-700:#3B4A96; --p-500:#4A6FA8; --p-300:#6F8FC8; --p-100:#E9EFF9;
      --bg:#FFFFFF; --surface:#F8FAFC; --border:#E5E7EB;
      --text-900:#111827; --text-700:#374151;
      --success:#22C55E; --warn:#F59E0B; --error:#EF4444; --info:#38BDF8;
      --r-sm:10px; --r-md:16px; --r-lg:24px;
      --shadow:0 6px 24px rgba(17,24,39,0.08);
      --shadow-hover:0 10px 30px rgba(17,24,39,0.12);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, sans-serif;
      color: var(--text-900);
      background:
        radial-gradient(600px 300px at 85% -10%, rgba(74,111,168,0.18), transparent 60%),
        radial-gradient(500px 260px at -10% 0%, rgba(46,52,120,0.12), transparent 60%),
        var(--surface);
    }
    .layout {
      display: grid;
      grid-template-columns: 240px 1fr;
      min-height: 100vh;
    }
    .sidebar {
      background: var(--bg);
      border-right: 1px solid var(--border);
      padding: 24px 18px;
      position: sticky;
      top: 0;
      height: 100vh;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
    }
    .brand img { height: 40px; }
    .brand-title { font-weight: 700; letter-spacing: -0.01em; }
    .nav {
      display: grid;
      gap: 6px;
    }
    .nav button {
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: var(--r-sm);
      border: 1px solid transparent;
      background: transparent;
      font-weight: 600;
      color: var(--text-700);
      cursor: pointer;
    }
    .nav button.active,
    .nav button:hover {
      background: var(--p-100);
      color: var(--p-900);
      border-color: var(--p-300);
    }
    .nav button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .main {
      padding: 24px 28px 32px;
    }
    .topbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--r-lg);
      padding: 12px 16px;
      box-shadow: var(--shadow);
    }
    .topbar-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .btn {
      border: 1px solid var(--p-300);
      background: var(--bg);
      color: var(--p-900);
      padding: 8px 14px;
      border-radius: var(--r-sm);
      font-weight: 600;
      letter-spacing: 0.02em;
      cursor: pointer;
      transition: box-shadow 0.2s ease, transform 0.2s ease, filter 0.2s ease;
    }
    .btn-primary { background: var(--p-900); color: #fff; border-color: var(--p-900); }
    .btn-danger { border-color: #f3b4b4; color: #b91c1c; background: #fff5f5; }
    .btn:disabled { opacity: 0.4; cursor: not-allowed; box-shadow: none; }
    .btn:focus-visible { outline: none; box-shadow: 0 0 0 3px rgba(111,143,200,0.35); }
    .input {
      min-width: 260px;
      height: 44px;
      padding: 0 12px;
      border-radius: var(--r-sm);
      border: 1px solid var(--border);
      background: var(--bg);
      color: var(--text-900);
    }
    .input:focus-visible { outline: none; box-shadow: 0 0 0 3px rgba(111,143,200,0.35); }
    .muted { color: var(--text-700); font-size: 13px; }
    h1 { font-size: 28px; margin: 18px 0 6px; letter-spacing: -0.01em; }
    .subhead { color: var(--text-700); margin: 0 0 18px; font-size: 14px; }
    .kpi-row {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 16px;
    }
    .card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      box-shadow: var(--shadow);
      padding: 16px;
    }
    .kpi-card strong { font-size: 22px; display: block; }
    .kpi-status { font-weight: 700; }
    .kpi-status.good { color: var(--success); }
    .kpi-status.warn { color: var(--warn); }
    .grid-two {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }
    .list { margin:0; padding-left: 18px; }
    li { margin: 10px 0; }
    .link { color: var(--p-700); cursor:pointer; text-decoration: none; font-weight: 600; }
    .link:hover { text-decoration: underline; }
    code { background: var(--p-100); padding:2px 6px; border-radius: 6px; }
    .err { color:#b00020; background:#fff1f1; padding:12px; border-radius:10px; display:none; white-space:pre-wrap; margin-top: 16px; }
    .pager { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top: 10px; }
    .kpi { display:flex; gap:12px; flex-wrap:wrap; }
    .kpi > div { border:1px solid var(--border); border-radius: var(--r-md); padding: 10px 12px; min-width: 200px; }
    .kpi strong { font-size: 20px; display:block; }
    .actions {
      display: grid;
      gap: 10px;
      margin-top: 12px;
    }
    .actions button {
      border: 1px solid var(--border);
      background: var(--bg);
      padding: 10px 12px;
      border-radius: var(--r-sm);
      font-weight: 600;
      color: var(--text-900);
      cursor: pointer;
      text-align: left;
    }
    .actions button:hover { border-color: var(--p-300); background: var(--p-100); }
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(17,24,39,0.45);
      z-index: 50;
      padding: 24px;
    }
    .modal.open { display: flex; }
    .modal-card {
      width: 100%;
      max-width: 720px;
      background: var(--bg);
      border-radius: var(--r-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-hover);
      padding: 20px;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .modal-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }
    .field {
      display: grid;
      gap: 6px;
    }
    .field label { font-size: 12px; color: var(--text-700); letter-spacing: 0.02em; }
    .field input, .field select, .field textarea {
      height: 40px;
      padding: 0 10px;
      border-radius: var(--r-sm);
      border: 1px solid var(--border);
      font-family: inherit;
    }
    .field textarea { height: 90px; padding: 8px 10px; }
    .field .checkbox {
      height: auto;
      width: auto;
    }
    .modal-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
      gap: 10px;
      flex-wrap: wrap;
    }
    .result {
      margin-top: 12px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--r-md);
      padding: 10px;
      max-height: 180px;
      overflow: auto;
      font-size: 12px;
    }
    @media (max-width: 980px) {
      .layout { grid-template-columns: 1fr; }
      .sidebar { position: static; height: auto; border-right: none; border-bottom: 1px solid var(--border); }
      .kpi-row { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .grid-two { grid-template-columns: 1fr; }
      .modal-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 640px) {
      .kpi-row { grid-template-columns: 1fr; }
      .input { min-width: 100%; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">
        <img src="/assets/southerniot-logo.png" alt="SouthernIoT" />
        <div class="brand-title">SouthernIoT</div>
      </div>
      <nav class="nav">
        <button id="tenantsBtn" class="active">Dashboard</button>
        <button id="appsBtn" disabled>Applications</button>
        <button id="devicesBtn" disabled>Devices</button>
        <button id="gatewaysBtn" disabled>Gateways</button>
      </nav>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="muted" id="crumbs">Tenants</div>
        <div class="topbar-actions">
          <input id="search" class="input" placeholder="Search…" />
          <button id="provisionBtn" class="btn btn-primary">Provision</button>
          <button id="backBtn" class="btn" disabled>Back</button>
          <button id="logoutBtn" class="btn btn-danger">Logout</button>
          <span class="muted" id="status">Idle</span>
        </div>
      </div>

      <h1 id="dashboardTitle">Admin Dashboard</h1>
      <p class="subhead" id="dashboardSubtitle">System administration and overview</p>

      <section class="kpi-row">
        <div class="card kpi-card">
          <div class="muted">Total Tenants</div>
          <strong id="kpiTenants">—</strong>
          <div class="muted">Active tenants</div>
        </div>
        <div class="card kpi-card">
          <div class="muted">Total Applications</div>
          <strong id="kpiApps">—</strong>
          <div class="muted">Registered apps</div>
        </div>
        <div class="card kpi-card">
          <div class="muted">Total Devices</div>
          <strong id="kpiDevices">—</strong>
          <div class="muted">Provisioned devices</div>
        </div>
        <div class="card kpi-card">
          <div class="muted">System Health</div>
          <strong class="kpi-status good" id="kpiHealth">Good</strong>
          <div class="muted" id="kpiHealthText">All services operational</div>
        </div>
      </section>

      <section class="grid-two">
        <div class="card">
          <div class="muted">Quick Actions</div>
          <div class="actions">
            <button id="actionTenants">Manage Tenants</button>
            <button id="actionApps">Manage Applications</button>
            <button id="actionDevices">View Devices</button>
            <button id="actionGateways">View Gateways</button>
          </div>
        </div>

        <div class="card">
          <div class="muted" id="listTitle">Current List</div>
          <div class="pager">
            <button id="prevBtn" class="btn">Prev</button>
            <button id="nextBtn" class="btn">Next</button>
            <span class="muted">Page: <span id="pageNum">1</span></span>
            <span class="muted">Total: <span id="total">0</span></span>
          </div>
          <ul class="list" id="list"></ul>
        </div>
      </section>

      <div class="err" id="err"></div>

      <div class="card" id="details" style="display:none;">
        <div class="muted" id="detailsTitle">Details</div>
        <div class="kpi" id="kpis"></div>
        <div class="muted" id="samples"></div>
        <pre class="muted" id="json" style="overflow:auto;"></pre>
      </div>
    </main>
  </div>

  <div class="modal" id="provisionModal">
    <div class="modal-card">
      <div class="modal-header">
        <div>
          <strong id="provisionTitle">Provision</strong>
          <div class="muted">Create tenants, applications, devices, and gateways</div>
        </div>
        <button id="closeProvision" class="btn">Close</button>
      </div>

      <div class="field">
        <label for="provisionAction">Action</label>
        <select id="provisionAction"></select>
      </div>

      <div class="modal-grid" id="provisionFields"></div>

      <div class="modal-footer">
        <span class="muted" id="provisionStatus">Ready</span>
        <div>
          <button id="submitProvision" class="btn btn-primary">Create</button>
        </div>
      </div>

      <pre class="result" id="provisionResult" style="display:none;"></pre>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
